<?xml version="1.0"?>
<root main_tree_to_execute="MainTree" BTCPP_format="4">
    <!-- ////////// -->
    <BehaviorTree ID="MainTree">
        <Sequence>
            <SetBlackboard output_key="DoorLocation" value="0;0" />
	        <CheckNode node="/findperson_action_server"/>
            <Action ID="Talk" speech="Hello. I am the robot from Team AndesRobot. I will demonstrate navigation,
             speech and social interaction. I will welcome the people entering this home and help them get seated."/>
	        <Action ID="MoveTo" location="{DoorLocation}"/>
	        <RetryUntilSuccessful num_attempts="-1">
		        <Action ID="See" object="Person" cardinality="1"/>
	        </RetryUntilSuccessful>
            <Action ID="Ask" speech="Hello. What is your name?" response="{person1}"/>
            <Script code=" greeting:='Nice to meet you, '+person1+'. I will remember your name. You may seat here,
            please follow me.' " />
            <Action ID="Talk" speech="{greeting}"/>
<!--
            <Action ID="Ask" speech="What is your favorite drink?" response="{drink1}"/>
            <Script code=" offering:='Perfect, I will remember that you like '+drink1+'.' " />
            <Action ID="Talk" speech="{offering}"/>
-->
            <Script code=" offering='This is your seat. Please take a seat, '+person1+'. I have stored your name.' " />
            <Action ID="Talk" speech="{offering}"/>

	        <Action ID="MoveTo" location="{DoorLocation}"/>
	        <RetryUntilSuccessful num_attempts="-1">
		        <Action ID="See" object="Person" cardinality="1"/>
	        </RetryUntilSuccessful>
            <Action ID="Ask" speech="Hello. What is your name?" response="{person2}"/>
            <Script code=" greeting:='Nice to meet you, '+person2+'. I will also remember your name. Please follow me to your seat.' " />
            <Action ID="Talk" speech="{greeting}"/>
<!--
            <Action ID="Ask" speech="What is your favorite drink?" response="{drink2}"/>
            <Script code=" offering:='Perfect, I will remember that you like '+drink2+'.' " />
            <Action ID="Talk" speech="{offering}"/>
-->

            <Script code=" offering='This is your seat. Please sit down, '+person2+'. I have stored your name.' " />
            <Action ID="Talk" speech="{offering}"/>

            <Script code=" introduction:=person2+', this is '+person1 " />
            <Action ID="Talk" speech="{introduction}"/>
            <Script code=" introduction=person1+', this is '+person2+'. It is a pleasure to assist both of you.' " />
            <Action ID="Talk" speech="{introduction}"/>

            <Action ID="Talk" speech="The interaction task is complete. Do you need anything else?."/>

        </Sequence>
    </BehaviorTree>

    <!-- ////////// -->
    <TreeNodesModel>
        <Action ID="Ask">
            <input_port default="What is your name?" name="speech"/>
            <output_port name="response"/>
        </Action>
        <Action ID="Talk">
            <input_port default="Hello" name="speech"/>
        </Action>
        <Action ID="MoveTo">
            <input_port default="DoorLocation" name="location"/>
        </Action>
        <Action ID="Remember">
            <input_port default="Person" name="object"/>
        </Action>
        <Action ID="See">
            <input_port default="Person" name="object"/>
        </Action>
    </TreeNodesModel>
    <!-- ////////// -->
</root>
